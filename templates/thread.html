<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/board-thread.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <title>Ï€chan - /{{ thread.board.id }}</title>
</head>
<body class="chan-bg vh-100 overflow-x-hidden d-flex flex-column align-items-center">
    <nav class="chan-nav d-flex w-100 border-bottom" style="height: fit-content; padding: 0.3rem 0.25rem;">
        <ul class="d-flex gap-2 justify-content-between w-100 list-unstyled m-0" style="height: fit-content; width: max-content; margin-bottom: 1px !important;">
            <div class="d-flex gap-1">
                {% for board_group in board_groups %}
                    {% if board_group.boards.count() > 0 %}
                        <div class="d-flex align-items-center align-content-center justify-content-center">
                            <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-right: 0.2rem !important; line-height: normal;">[</p>
                            <ul class="d-flex gap-2 p-0 m-0" style="height: fit-content;">
                                {% for board in board_group.boards %}
                                <a href="{{ url_for('Admin.Board' if api_key else 'Boards.Board', id=board.id, **({'api_key': api_key} if api_key else {})) }}" title="{{ board.name }}" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; line-height: normal;">/{{ board.id }}</a>
                                {% endfor %}
                            </ul>
                            <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-left: 0.2rem !important; line-height: normal;">]</p>    
                        </div>
                    {% endif %}
                {% endfor %}    
            </div>
            
            <div class="d-flex align-items-center align-content-center justify-content-center">
                <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-right: 0.2rem !important; line-height: normal;">[</p>
                <a href="{{ url_for('Admin.home' if api_key else 'Index.home', **({'api_key': api_key} if api_key else {})) }}" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; line-height: normal;">Home</a>
                <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-left: 0.2rem !important; line-height: normal;">]</p>
            </div>
        </ul>
    </nav> 
    <main class="d-flex w-100 flex-column align-items-center" style="height: fit-content;">
        <div class="chan-title d-flex flex-column border-bottom border-black fw-bold align-items-center align-content-center w-100 p-3 bg-dark gap-2" style="background: linear-gradient(to right, var(--bs-label-gradient-start), var(--bs-label-gradient-end));">
            <div class="d-flex align-items-center align-content-center justify-content-start gap-2">
                <p class="m-0" style="color: var(--bs-primary); height: fit-content; font-size: 2.5rem; line-height: 1;">/{{ thread.board.id }}</p>
                <p class="m-0" style="height: fit-content; font-size: 2.5rem; line-height: 1;">-</p>
                <p class="m-0" style="height: fit-content; font-size: 2.5rem; line-height: 1;">{{ thread.board.name }}</p>    
            </div>
            <p class="text-white-50 text-ellipsis m-0 bg-black bg-opacity-25 px-1" style="font-size: 0.7rem;">Thread No. {{ thread.id }}</p>
        </div>

        <!-- New reply modal -->
        <div class="modal fade" id="newReply" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" data-bs-theme="dark">
                <div class="modal-content chan-thread-modal">
                    <div class="modal-header" style="border-color: #5e5e5e;">
                    <h1 class="modal-title bg-body-secondary border border-1 border-dark fs-5 px-1 font-monospace" id="exampleModalLabel">Reply data:</h1>
                    <button type="button" class="btn-close"  data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form class="d-flex flex-column gap-2" action="" method="post">

                            <div>
                                <label class="d-flex gap-1 align-items-center fst-italic text-white m-0" style="max-width: 800px; font-size: 0.8rem; font-family: 'Courier New', Courier, monospace; white-space: nowrap;">Reply content:<hr class="border-white w-100 my-0" style="height: fit-content; margin-bottom: 1px !important;"></label>
                                <textarea class="w-100" placeholder="Enter content" id="reply_content" required></textarea> 
                            </div>

                            <input type="hidden" name="new_reply_type" value="{{ 1 if api_key else 0 }}" id="new_reply_type" required>
                            <input type="file" name="" accept=".jpg,.png,.gif" id="image-r" >

                            <input type="hidden" id="thread_or_reply_id" value="">
                        </form>
                    </div>
                    <div class="d-flex justify-content-between modal-footer" style="border-color: #5e5e5e;">
                    <button type="button" class="btn btn-secondary chan-button-close w-100" style="max-width: 80px;" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary chan-button w-100" style="max-width: 150px;" onclick="postReply()">Post reply</button>
                    </div>
                </div>
            </div>
        </div>
  
        <hr class="border-white w-100 my-0" style="margin-top: 1rem !important;">
            
            <div class="d-flex w-100 px-2 py-1 align-items-start">
                <a href="{{ url_for('Admin.Board' if api_key else 'Boards.Board', id=thread.board.id, **({'api_key': api_key} if api_key else {})) }}" title="{{ thread.board.name }}" style="font-size: 0.8rem; font-family: 'Courier New'; height: fit-content;">Back to /{{ thread.board.id }}</a>
            </div>
            <link id="theme-style" rel="stylesheet" href="{{ url_for('static', filename='css/board-thread.css') }}">

        <hr class="border-white w-100 my-0" style="margin-bottom: 1.1rem !important;">
  
        <!-- Rendering Threads and Replies -->
        <section class="d-flex flex-column align-items-start w-100 px-3 gap-3" style="padding-bottom: 1rem; height: fit-content;" id="threads">
            
            {% macro render_replies(replies, level, thread) %}

                {% for reply in replies %}
                        
                    <div id="r{{ reply.id }}" class="chan-{{ 'admin-' if reply.type == 1 }}thread-info d-flex flex-column" style="min-width: 300px; margin-left: {{ 20 * level }}px; width: fit-content;">
                        <div class="d-flex justify-content-start align-content-start gap-1">
                            <div class="d-flex gap-1 align-items-center justify-content-start m-0 text-ellipsis" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">
                                <span class="m-0 fw-bold" style="font-size: 0.7rem; {{ 'color: rgba(255, 255, 255, 0.700);' if reply.type == 0 else 'color: rgba(0, 255, 136);' }}">
                                    {{ 'Admin:' if reply.type == 1 else 'Anon:' }}
                                </span>
                                <span class="m-0 text-ellipsis" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">
                                    {{ reply.user_token }}
                                </span>
                                {% if reply.user_token == thread.user_token %}
                                    <span class="text-info m-0 text-ellipsis" style="font-size: 0.7rem;">(OP)</span>
                                {% endif %}
                                {% if reply.type == 1 %}
                                    <img style="width: 15px; height: 15px;" src="{{ url_for('static', filename='pi.svg') }}" alt="">
                                {% endif %}
                            </div>
                            
                            <hr class="m-0" style="width: 1px; border-left: solid 1px;">
                            <p class="m-0 text-ellipsis" style="font-size: 11px; color: rgba(255, 255, 255, 0.700);">Reply No.{{ reply.id }}</p>
                            <hr class="m-0" style="width: 1px; border-left: solid 1px;">
                            <a
                                onclick="highlightPost({{ 'r' ~ (reply.reply.id | string) if reply.reply else 't' ~ (reply.thread.id | string) }})"
                                href="#{{ 'r' ~ (reply.reply.id | string) if reply.reply else 't' ~ (reply.thread.id | string) }}"
                                class="m-0 text-ellipsis" style="font-size: 11px; color: var(--post-highlight);">
                                Replying to: {{ 'r-' ~ (reply.reply.id | string) if reply.reply else 't-' ~ (reply.thread.id | string)}}
                            </a>
                        </div>

                        <p class="chan-text-content" style="min-height: {{'1.5rem' if reply.image else '2.5rem'}};">{{ reply.content|safe }}</p>
                        {% if reply.image %}
                            <div class="d-flex flex-column justify-content-center" style="width: 30%;" id="img-div-r{{ reply.id }}">
                                <img class="rounded-1" style="width: 100%; height: auto; max-height: 400px;" src="{{ url_for('Images.Image', id=reply.image.id) }}" onclick="maxOrMin({{ reply.id }}, 'r')">
                                <div class="d-flex gap-1">
                                    <p style="font-size: 0.7rem; color: #696969;" class="m-0">File: </p>
                                    <a style="font-size: 0.7rem;" class="m-0 text-ellipsis" href="{{ url_for('Images.Image', id=reply.image.id) }}">{{ reply.image.name }}</a>
                                </div>
                                <p style="font-size: 0.7rem; color: #696969;" class="m-0 p-0">({{ (reply.image.size|int / 1024)|int }}KB {{ reply.image.measures }})</p>                    
                            </div>
                        {% endif %}
                        <div class="d-flex justify-content-between">
                            <div class="d-flex gap-1">
                                <p class="m-0" style="font-size: 11px; color: rgba(255, 255, 255, 0.700);">
                                    {{ '%02d' | format(reply.date.day) }}/{{ '%02d' | format(reply.date.month) }}/{{ reply.date.year }}
                                </p>
                                <hr class="m-0 h-100" style="width: 1px; border-left: solid 1px;">
                                <p class="m-0" style="font-size: 11px; color: rgba(255, 255, 255, 0.700);">{{ reply.time }}</p>
                                <p class="m-0" style="font-size: 11px; color: rgba(255, 255, 255, 0.700);">UTC</p>
                            </div>

                            <div class="d-flex justify-content-center gap-1">
                                <button onclick="submitVote(1, {{ reply.id }}, 'r')" title="{{ reply.votes|selectattr('up_or_down', 'equalto', 1)|list|length }}" class="d-flex p-0 border-0 bg-transparent text-white" style="height: fit-content;">
                                    <i class="fa-solid fa-caret-up px-1" id="1r{{ reply.id }}" style="font-size: 0.9rem; padding-top: 0.15rem; background-color: rgba(0, 153, 255, 0.2); border-radius: 3px; height: fit-content;"></i>
                                </button>
                                <button onclick="submitVote(0, {{ reply.id }}, 'r')" title="{{ reply.votes|selectattr('up_or_down', 'equalto', 0)|list|length }}" class="d-flex p-0 border-0 bg-transparent text-white" style="height: fit-content;">
                                    <i class="fa-solid fa-caret-down px-1" id="0r{{ reply.id }}" style="font-size: 0.9rem; padding-bottom: 0.15rem; background-color: rgba(255, 78, 78, 0.2); border-radius: 3px; height: fit-content;"></i>
                                </button>
                                <button class="d-flex gap-1 align-items-center text-white p-0 border-0 px-1" style="background-color: rgba(0, 255, 89, 0.1); border-radius: 3px;" onclick="replyModal('r{{ reply.id }}')" type="button" data-bs-toggle="modal" data-bs-target="#newReply">
                                    <i style="font-size: 0.7rem;" class="fa-solid fa-reply"></i>
                                    <p style="font-size: 0.7rem;" class="m-0">Reply</p>   
                                </button>
                                {% if api_key %}
                                    <button onclick="deletePost({{ reply.id }}, 'r')" class="d-flex gap-1 align-items-center text-white p-0 border-0 px-1" style="background-color: rgba(243, 35, 35, 0.2); border-radius: 3px;" type="button">
                                        <i style="font-size: 0.7rem;" class="fa-solid fa-eraser"></i>
                                        <p style="font-size: 0.7rem;" class="m-0">Delete</p>   
                                    </button>
                                {% endif %}
                            </div>
                        </div>

                    </div>
                    
                    <!-- Render nested replies recursively with updated level -->
                    {% if reply.reply_replies %}
                        
                        {{ render_replies(reply.reply_replies, level + 1, thread) }}
                        
                    {% endif %}
                      

                {% endfor %}

            {% endmacro %}


            {% if thread.type == 1 %}
                <div class="d-flex gap-1 overflow-x-auto" id="img-div-t{{ thread.id }} style="max-width: 100vw;">
                    {% if thread.image %}
                        <div class="d-flex flex-column justify-content-start" style="max-width: 235px; max-height: fit-content; min-width: 200px;">
                            <img class="rounded-1 shadow" src="{{ url_for('Images.Image', id=thread.image.id) }}" onclick="maxOrMin({{ thread.id }}, 't')">
                            <div class="d-flex gap-1">
                                <p style="font-size: 0.7rem; color: #696969;" class="m-0">File: </p>
                                <a style="font-size: 0.7rem;" class="m-0 text-ellipsis" href="{{ url_for('Images.Image', id=thread.image.id) }}">{{ thread.image.name }}</a>
                            </div>
                            <p style="font-size: 0.7rem; color: #696969;" class="m-0 p-0">({{ (thread.image.size|int / 1024)|int }}KB {{ thread.image.measures }})</p>                    
                        </div>
                    {% endif %}
                    <div class="d-flex flex-column gap-1 w-100">
                        
                        <div id="t{{ thread.id }}" class="chan-admin-thread-info border-info-subtle" style="min-width: 350px; width: fit-content; min-width: 200px;">
                            <div class="d-flex gap-2">
                                <p class="chan-thread-title text-ellipsis m-0 text-decoration-none fst-italic" style="font-weight: 500; text;">{{ thread.title }}</p>
                                <div class="d-flex flex-column justify-content-around">
                                    <div class="d-flex align-items-center gap-1">
                                        <p class="m-0" style="font-size: 0.7rem; color: rgba(0, 255, 136);"><span class="fw-bold">Admin:</span></p>
                                        <p class="m-0 text-ellipsis" style="font-size: 0.7rem !important; color: rgba(255, 255, 255, 0.700);">{{ thread.user_token }}</p>
                                        <img style="width: 15px; height: 15px;" src="{{ url_for('static', filename='pi.svg') }}" alt="">
                                    </div>
                                    <p class="m-0 text-ellipsis" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">Thread No.{{ thread.id }}</p>      
                                </div>
                            </div>

                            <p class="chan-text-content">{{ thread.content|safe }}</p>

                            <div class="d-flex justify-content-between">
                                <div class="d-flex gap-1">
                                    <p class="m-0" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">
                                        {{ '%02d' | format(thread.date.day) }}/{{ '%02d' | format(thread.date.month) }}/{{ thread.date.year }}
                                    </p>
                                    <hr class="m-0 h-100" style="width: 1px; border-left: solid 1px;">
                                    <p class="m-0" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">{{ thread.time }}</p>
                                    <p class="m-0" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">UTC</p>    
                                </div>
                                <div class="d-flex justify-content-center gap-1">
                                    <button onclick="submitVote(1, {{ thread.id }}, 't')"                                    title="{{ thread.votes|selectattr('up_or_down', 'equalto', 1)|list|length }}" class="d-flex p-0 border-0 bg-transparent text-white" style="height: fit-content;">
                                        <i class="fa-solid fa-caret-up px-1" id="1t{{ thread.id }}" style="font-size: 0.9rem; padding-top: 0.15rem; background-color: rgba(0, 153, 255, 0.2); border-radius: 3px; height: fit-content;"></i>
                                    </button>
                                    <button onclick="submitVote(0, {{ thread.id }}, 't')" title="{{ thread.votes|selectattr('up_or_down', 'equalto', 0)|list|length }}" class="d-flex p-0 border-0 bg-transparent text-white" style="height: fit-content;">
                                        <i class="fa-solid fa-caret-down px-1" id="0t{{ thread.id }}" style="font-size: 0.9rem; padding-bottom: 0.15rem; background-color: rgba(255, 78, 78, 0.2); border-radius: 3px; height: fit-content;"></i>
                                    </button>
                                    <button class="d-flex gap-1 align-items-center text-white p-0 border-0 px-1" style="background-color: rgba(0, 255, 89, 0.1); border-radius: 3px;" onclick="replyModal('t{{ thread.id }}')" type="button" data-bs-toggle="modal" data-bs-target="#newReply">
                                        <i style="font-size: 0.7rem;" class="fa-solid fa-reply"></i>
                                        <p style="font-size: 0.7rem;" class="m-0">Reply</p>   
                                    </button>
                                    {% if api_key %}
                                        <button onclick="deletePost({{ thread.id }}, 't')" class="d-flex gap-1 align-items-center text-white p-0 border-0 px-1" style="background-color: rgba(243, 35, 35, 0.2); border-radius: 3px;" type="button">
                                            <i style="font-size: 0.7rem;" class="fa-solid fa-eraser"></i>
                                            <p style="font-size: 0.7rem;" class="m-0">Delete</p>   
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {{ render_replies(thread.replies, 2, thread) }}    
                    </div>    
                </div>
            {% else %}
                <div class="d-flex gap-1 overflow-x-auto" id="img-div-t{{ thread.id }}" style="max-width: 100vw;">
                    {% if thread.image %}
                        <div class="d-flex flex-column justify-content-start" style="max-width: 235px; max-height: fit-content;">
                            <img class="rounded-1 shadow" src="{{ url_for('Images.Image', id=thread.image.id) }}" onclick="maxOrMin({{ thread.id }}, 't')">
                            <div class="d-flex gap-1">
                                <p style="font-size: 0.7rem; color: #696969;" class="m-0">File: </p>
                                <a style="font-size: 0.7rem;" class="m-0 text-ellipsis" href="{{ url_for('Images.Image', id=thread.image.id) }}">{{ thread.image.name }}</a>
                            </div>
                            <p style="font-size: 0.7rem; color: #696969;" class="m-0 p-0">({{ (thread.image.size|int / 1024)|int }}KB {{ thread.image.measures }})</p>                    
                        </div>
                    {% endif %}
                    <div class="d-flex flex-column gap-1 w-100">
                        
                        <div id="t{{ thread.id }}" class="chan-thread-info border-info-subtle" style="min-width: 350px; width: fit-content;">
                            <div class="d-flex gap-2">
                                <p class="chan-thread-title text-ellipsis m-0 text-decoration-none fst-italic" style="font-weight: 500; text;">{{ thread.title }}</p>
                                <div class="d-flex flex-column justify-content-around">
                                    <p class="m-0 text-ellipsis" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);"><span class="fw-bold">Anon:</span> {{ thread.user_token }}</p>
                                    <p class="m-0 text-ellipsis" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">Thread No.{{ thread.id }}</p>      
                                </div>
                            </div>

                            <p class="chan-text-content">{{ thread.content|safe }}</p>

                            <div class="d-flex justify-content-between">
                                <div class="d-flex gap-1">
                                    <p class="m-0" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">
                                        {{ '%02d' | format(thread.date.day) }}/{{ '%02d' | format(thread.date.month) }}/{{ thread.date.year }}
                                    </p>
                                    <hr class="m-0 h-100" style="width: 1px; border-left: solid 1px;">
                                    <p class="m-0" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">{{ thread.time }}</p>
                                    <p class="m-0" style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.700);">UTC</p>    
                                </div>
                                <div class="d-flex justify-content-center gap-1">
                                    <button onclick="submitVote(1, {{ thread.id }}, 't')"                                    title="{{ thread.votes|selectattr('up_or_down', 'equalto', 1)|list|length }}" class="d-flex p-0 border-0 bg-transparent text-white" style="height: fit-content;">
                                        <i class="fa-solid fa-caret-up px-1" id="1t{{ thread.id }}" style="font-size: 0.9rem; padding-top: 0.15rem; background-color: rgba(0, 153, 255, 0.2); border-radius: 3px; height: fit-content;"></i>
                                    </button>
                                    <button onclick="submitVote(0, {{ thread.id }}, 't')" title="{{ thread.votes|selectattr('up_or_down', 'equalto', 0)|list|length }}" class="d-flex p-0 border-0 bg-transparent text-white" style="height: fit-content;">
                                        <i class="fa-solid fa-caret-down px-1" id="0t{{ thread.id }}" style="font-size: 0.9rem; padding-bottom: 0.15rem; background-color: rgba(255, 78, 78, 0.2); border-radius: 3px; height: fit-content;"></i>
                                    </button>
                                    <button class="d-flex gap-1 align-items-center text-white p-0 border-0 px-1" style="background-color: rgba(0, 255, 89, 0.1); border-radius: 3px;" onclick="replyModal('t{{ thread.id }}')" type="button" data-bs-toggle="modal" data-bs-target="#newReply">
                                        <i style="font-size: 0.7rem;" class="fa-solid fa-reply"></i>
                                        <p style="font-size: 0.7rem;" class="m-0">Reply</p>   
                                    </button>
                                    {% if api_key %}
                                        <button onclick="deletePost({{ thread.id }}, 't')" class="d-flex gap-1 align-items-center text-white p-0 border-0 px-1" style="background-color: rgba(243, 35, 35, 0.2); border-radius: 3px;" type="button">
                                            <i style="font-size: 0.7rem;" class="fa-solid fa-eraser"></i>
                                            <p style="font-size: 0.7rem;" class="m-0">Delete</p>   
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {{ render_replies(thread.replies, 2, thread) }}    
                    </div>    
                </div>
            {% endif %}
            

        <hr class="border-white w-100 m-0">
        <ul class="d-flex gap-2 justify-content-center w-100 list-unstyled m-0" style="height: fit-content; width: max-content;">
            {% for board_group in board_groups %}
                {% if board_group.boards.count() > 0 %}
                    <div class="d-flex align-items-center align-content-center justify-content-center">
                        <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-right: 0.2rem !important; line-height: normal;">[</p>
                        <ul class="d-flex gap-2 p-0 m-0" style="height: fit-content;">
                            {% for board in board_group.boards %}
                            <a href="{{ url_for('Admin.Board' if api_key else 'Boards.Board', id=board.id, **({'api_key': api_key} if api_key else {})) }}" title="{{ board.name }}" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; line-height: normal;">/{{ board.id }}</a>
                            {% endfor %}
                        </ul>
                        <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-left: 0.2rem !important; line-height: normal;">]</p>    
                    </div>
                {% endif %}
            {% endfor %}
            <div class="d-flex align-items-center align-content-center justify-content-center">
                <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-right: 0.2rem !important; line-height: normal;">[</p>
                <a href="{{ url_for('Admin.home' if api_key else 'Index.home', **({'api_key': api_key} if api_key else {})) }}" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; line-height: normal;">Home</a>
                <p class="m-0 text-white-50" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin-left: 0.2rem !important; line-height: normal;">]</p>
            </div>
        </ul>
        </section>
        

    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='js/board-thread.js') }}"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const themeLink = document.getElementById("theme-style");
    
            // Apply saved style across all pages
            const savedStyle = localStorage.getItem("selectedStyle") || "board-thread";
    
            // Set the href dynamically using the rendered url_for value
            themeLink.href = "{{ url_for('static', filename='css/') }}" + savedStyle + ".css";
    
            // Check if the select dropdown exists
            const select = document.getElementById("style_id");
            if (select) {
                // Set dropdown to match saved style
                select.value = savedStyle;
    
                // Change theme and save selection
                select.addEventListener("change", function () {
                    const newStyle = select.value;
                    localStorage.setItem("selectedStyle", newStyle);
                    themeLink.href = "{{ url_for('static', filename='css/') }}" + newStyle + ".css";
                });
            }
        });
    </script>
    {% if api_key %}
        <script>
            async function deletePost(id, post_type){
                
                const currentUrl = window.location.href;
                const url = new URL(currentUrl);
                const params = new URLSearchParams(url.search);
                const apiKey = params.get('api_key')

                const response = await fetch(`/${post_type == 't' ? 'thread' : 'reply'}/${id}?api_key=${apiKey}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }

                const responseData = await response.json();

                location.reload()
                
            }
        </script>
    {% endif %}
</body>
</html>